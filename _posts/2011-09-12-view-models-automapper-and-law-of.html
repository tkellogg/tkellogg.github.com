---
layout: post
title: "View Models, AutoMapper, and The Law of Demeter"
date: 2011-09-12
comments: false
categories:
 - view models
 - engineering
 - web
---

<div class='post'>
<div>The <a href="http://haacked.com/archive/2009/07/14/law-of-demeter-dot-counting.aspx">Law of Demeter</a>&nbsp;was created for the intent of simplifying object hierarchies and structures. Obviously it's not a blanket sort of law (doesn't seem to apply to <a href="http://www.themomorohoax.com/2009/02/25/how-to-write-a-clean-ruby-dsl-part-2-line-by-line-with-machinist-rails">DSL's </a>or fluent interfaces). But it is handy to keep in mind when modelling a domain.&nbsp;</div><div><br /></div><div>A classic example of a shortcomings of the Law of Demeter is name example: passing a model to a view that has a name object (<span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Model.Name.First</span>, <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Model.Name.Last</span>, etc) versus passing a flattened view model (<span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Model.FirstName</span>, <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Model.LastName</span>, etc). I think this is a great application of view models.</div><div><br /></div><div>I like the idea of view models because they're a great way to express view-specific business logic. The FirstName/LastName is an example, but they're also great for holding data necessary to populate drop down lists and summary views. Beyond code, view models are also a good example of the .NET community's ability to innovate new solutions to old problems (akin to&nbsp;<a href="http://timkellogg.blogspot.com/2011/08/parenthetical-thesis-on-rubynet-or.html">my thoughts about the ruby community</a>)&nbsp;</div><div><br /></div><div><span class="Apple-style-span" style="font-size: large;"><b>Yes, But...</b></span></div><div><span class="Apple-style-span" style="font-size: large;"><b><br /></b></span></div><div>While I definitely understand the benefits of view models, I'm still trying to figure out the best way to use them. When first creating view models the urge is to write and populate them by hand. This quickly becomes very tiresome. Enter <a href="http://automapper.codeplex.com/">AutoMapper</a>.&nbsp;</div><div><br /></div><div>AutoMapper is an object-to-object mapper designed very specifically for flattening models into view models. It bases it's decisions on conventions and provides a fluent interface for the remaining anomalies. It is a savior for those writing view models by hand.</div><div><br /></div><div>AutoMapper works only in one direction. You take an existing model and map and migrate the data into a view model. Going backwards; however, is another story. One big limitation of AutoMapper is that you can't map from two different source types to the same destination type. This makes it difficult or impossible to use AutoMapper to do bidirectional mappings (for instance, if you want to use AutoMapper when updating the model from FormCollection).</div><div><br /></div><div>There is quite a bit more I want to say on this matter, which I will continue in a second part</div></div>
