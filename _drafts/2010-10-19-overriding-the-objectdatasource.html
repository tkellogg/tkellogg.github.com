---
layout: post
title: "Overriding the ObjectDataSource"
date: 2010-10-19
comments: false
---

<div class='post'>
In a <a href="http://timkellogg.blogspot.com/2010/10/object-form-mapping.html">previous post</a> I talked about mapping HTML form elements (or HTTP parameters) to objects similar to how ORM maps objects to database tables. ASP.NET did a great thing for those of us who love ORM tools when they came up with the FormView and ObjectDataSource. But I ran into some significant problems in using the ODS for more complex Update operations.<br /><br />The ODS uses reflection to resolve a method to invoke with given parameters. You provide it with the name of a "SelectMethod" and SelectParameter (perhaps a QueryStringParameter, SessionParameter, or ControlParameter?) and the ODS will resolve which method overload to invoke based on the parameter names you provided and data bind the returned object to the FormView.<br /><br />The update operation works similarly and has this freaking awesome feature where it'll call a method with a parameter of a complex type if the parameter type is the same as the type of the object that the FormView is currently bound to. That the FormView + ObjectDataSource marshalls and unmarshells the object so smoothly was an excellent feature in ASP.NET 2.0. The only thing that I am dissatisfied with is the fact that, if the ODS is marshalling an object for an update operation, it can't call an update method with more than one parameter.<br /><br />To give an example for why this sucks, if I want to call a method that updates an account's properties I would probably have a method signature like<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">public static void Save(Account account)</div><br />This method call would go very smoothly. The I would map the properties of Account to different form elements and the FormView would marshall and unmarshall the object between HTML and factory methods.<br /><br />However, what if the requirements change such that we now require a comment for each change to an account? This would require another database table (a many-to-one relationship) and hence wouldn't make sense to include as part of the Account object. So we would probably change the method signature to be something like:<br /><i></i><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">public static void Save(Account account, string comment)</div><br />I would naturally assume that this would be easy for the ObjectDataSource to handle since it handled the other Select and Update operations so smoothly. However, the <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.updatemethod.aspx">MSDN documentation</a> clearly states that it isn't capable of resolving this type of method signature. I was so frustrated that Microsoft did so well on the ObjectDataSource thus far yet stopped short of actually making a truly cool control that I did some work and created my own extension of the ODS.<br /><br /><span style="font-size: large;">Warning: Dark words following</span></div>
